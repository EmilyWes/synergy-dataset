import pandas as pd
import sys

sys.path.append("../../scripts")
import utils

# get search
search = pd.read_csv("https://osf.io/nqm3v/download")
search.rename(columns={"label_included": "label_abstract_included"}, inplace=True)
search = utils.extract_doi(search, "DOI")
search["url"] = search["url"].astype(str)
search["url"] = search["url"].apply(lambda x: "&".join(x.split("http")))
search = utils.extract_doi(search, "url", "", "&")

# FT taken from paper references
inclusions = [
    {"openalex_id": "https://openalex.org/works/w1012667521"},
    {"openalex_id": "https://openalex.org/works/w110802059"},
    {"openalex_id": "https://openalex.org/works/w1146504"},
    {"openalex_id": "https://openalex.org/works/w116197087"},
    {"openalex_id": "https://openalex.org/works/w128673512"},
    {"openalex_id": "https://openalex.org/works/w1502851049"},
    {"openalex_id": "https://openalex.org/works/w1510504782"},
    {"openalex_id": "https://openalex.org/works/w1513791783"},
    {"openalex_id": "https://openalex.org/works/w1552781900"},
    {"openalex_id": "https://openalex.org/works/w1559821202"},
    {"openalex_id": "https://openalex.org/works/w1570976642"},
    {"openalex_id": "https://openalex.org/works/w1572694034"},
    {"openalex_id": "https://openalex.org/works/w1572928198"},
    {"openalex_id": "https://openalex.org/works/w1582541632"},
    {"openalex_id": "https://openalex.org/works/w1584230737"},
    {"openalex_id": "https://openalex.org/works/w1598599709"},
    {"openalex_id": "https://openalex.org/works/w1603202186"},
    {"openalex_id": "https://openalex.org/works/w1604561742"},
    {"openalex_id": "https://openalex.org/works/w1657555008"},
    {"openalex_id": "https://openalex.org/works/w1666954427"},
    {"openalex_id": "https://openalex.org/works/w170044459"},
    {"openalex_id": "https://openalex.org/works/w185457627"},
    {"openalex_id": "https://openalex.org/works/w1892608371"},
    {"openalex_id": "https://openalex.org/works/w190986945"},
    {"openalex_id": "https://openalex.org/works/w1966171511"},
    {"openalex_id": "https://openalex.org/works/w1976231030"},
    {"openalex_id": "https://openalex.org/works/w1977979273"},
    {"openalex_id": "https://openalex.org/works/w1986997848"},
    {"openalex_id": "https://openalex.org/works/w1989791552"},
    {"openalex_id": "https://openalex.org/works/w1991722958"},
    {"openalex_id": "https://openalex.org/works/w1993880858"},
    {"openalex_id": "https://openalex.org/works/w1999360601"},
    {"openalex_id": "https://openalex.org/works/w2005138743"},
    {"openalex_id": "https://openalex.org/works/w2006292343"},
    {"openalex_id": "https://openalex.org/works/w2008600765"},
    {"openalex_id": "https://openalex.org/works/w2015710403"},
    {"openalex_id": "https://openalex.org/works/w2020190914"},
    {"openalex_id": "https://openalex.org/works/w2023727762"},
    {"openalex_id": "https://openalex.org/works/w2030390755"},
    {"openalex_id": "https://openalex.org/works/w2040291538"},
    {"openalex_id": "https://openalex.org/works/w2041478210"},
    {"openalex_id": "https://openalex.org/works/w2045365986"},
    {"openalex_id": "https://openalex.org/works/w2048424354"},
    {"openalex_id": "https://openalex.org/works/w2048868034"},
    {"openalex_id": "https://openalex.org/works/w2050306953"},
    {"openalex_id": "https://openalex.org/works/w2050461175"},
    {"openalex_id": "https://openalex.org/works/w2053039686"},
    {"openalex_id": "https://openalex.org/works/w2058027032"},
    {"openalex_id": "https://openalex.org/works/w2061977804"},
    {"openalex_id": "https://openalex.org/works/w2068367493"},
    {"openalex_id": "https://openalex.org/works/w2068617850"},
    {"openalex_id": "https://openalex.org/works/w2070547097"},
    {"openalex_id": "https://openalex.org/works/w2076453587"},
    {"openalex_id": "https://openalex.org/works/w2079052320"},
    {"openalex_id": "https://openalex.org/works/w2087871380"},
    {"openalex_id": "https://openalex.org/works/w2093961770"},
    {"openalex_id": "https://openalex.org/works/w2095363798"},
    {"openalex_id": "https://openalex.org/works/w2096061301"},
    {"openalex_id": "https://openalex.org/works/w2104255052"},
    {"openalex_id": "https://openalex.org/works/w2105229062"},
    {"openalex_id": "https://openalex.org/works/w2108249499"},
    {"openalex_id": "https://openalex.org/works/w2110595762"},
    {"openalex_id": "https://openalex.org/works/w2117691894"},
    {"openalex_id": "https://openalex.org/works/w2129816085"},
    {"openalex_id": "https://openalex.org/works/w2135730600"},
    {"openalex_id": "https://openalex.org/works/w2135806589"},
    {"openalex_id": "https://openalex.org/works/w2139403502"},
    {"openalex_id": "https://openalex.org/works/w2142644047"},
    {"openalex_id": "https://openalex.org/works/w2144062847"},
    {"openalex_id": "https://openalex.org/works/w2145862085"},
    {"openalex_id": "https://openalex.org/works/w214668715"},
    {"openalex_id": "https://openalex.org/works/w2148824778"},
    {"openalex_id": "https://openalex.org/works/w2149695156"},
    {"openalex_id": "https://openalex.org/works/w2153308398"},
    {"openalex_id": "https://openalex.org/works/w2154068546"},
    {"openalex_id": "https://openalex.org/works/w2156396199"},
    {"openalex_id": "https://openalex.org/works/w2156471102"},
    {"openalex_id": "https://openalex.org/works/w2158080564"},
    {"openalex_id": "https://openalex.org/works/w2159875025"},
    {"openalex_id": "https://openalex.org/works/w2161058520"},
    {"openalex_id": "https://openalex.org/works/w2161584222"},
    {"openalex_id": "https://openalex.org/works/w2165714295"},
    {"openalex_id": "https://openalex.org/works/w2166338594"},
    {"openalex_id": "https://openalex.org/works/w2166353773"},
    {"openalex_id": "https://openalex.org/works/w2219924138"},
    {"openalex_id": "https://openalex.org/works/w2235592767"},
    {"openalex_id": "https://openalex.org/works/w223731380"},
    {"openalex_id": "https://openalex.org/works/w2287264615"},
    {"openalex_id": "https://openalex.org/works/w2336440220"},
    {"openalex_id": "https://openalex.org/works/w2411303030"},
    {"openalex_id": "https://openalex.org/works/w2421344716"},
    {"openalex_id": "https://openalex.org/works/w2461219731"},
    {"openalex_id": "https://openalex.org/works/w2510136811"},
    {"openalex_id": "https://openalex.org/works/w2514562079"},
    {"openalex_id": "https://openalex.org/works/w2520133917"},
    {"openalex_id": "https://openalex.org/works/w2579917161"},
    {"openalex_id": "https://openalex.org/works/w2588271694"},
    {"openalex_id": "https://openalex.org/works/w2588793797"},
    {"openalex_id": "https://openalex.org/works/w2724912283"},
    {"openalex_id": "https://openalex.org/works/w2725463557"},
    {"openalex_id": "https://openalex.org/works/w2726121253"},
    {"openalex_id": "https://openalex.org/works/w2726840143"},
    {"openalex_id": "https://openalex.org/works/w276949177"},
    {"openalex_id": "https://openalex.org/works/w281383721"},
    {"openalex_id": "https://openalex.org/works/w2900656794"},
    {"openalex_id": "https://openalex.org/works/w2915188330"},
    {"openalex_id": "https://openalex.org/works/w2993008851"},
    {"openalex_id": "https://openalex.org/works/w3020883184"},
    {"openalex_id": "https://openalex.org/works/w3022419584"},
    {"openalex_id": "https://openalex.org/works/w3121229127"},
    {"openalex_id": "https://openalex.org/works/w3121377324"},
    {"openalex_id": "https://openalex.org/works/w3121561657"},
    {"openalex_id": "https://openalex.org/works/w3121801322"},
    {"openalex_id": "https://openalex.org/works/w3122463911"},
    {"openalex_id": "https://openalex.org/works/w3122523482"},
    {"openalex_id": "https://openalex.org/works/w3123009801"},
    {"openalex_id": "https://openalex.org/works/w3123506010"},
    {"openalex_id": "https://openalex.org/works/w3124584715"},
    {"openalex_id": "https://openalex.org/works/w3124701529"},
    {"openalex_id": "https://openalex.org/works/w3125029338"},
    {"openalex_id": "https://openalex.org/works/w3125425438"},
    {"openalex_id": "https://openalex.org/works/w3125810096"},
    {"openalex_id": "https://openalex.org/works/w3125851831"},
    {"openalex_id": "https://openalex.org/works/w3140407863"},
    {"openalex_id": "https://openalex.org/works/w3149807077"},
    {"openalex_id": "https://openalex.org/works/w33270799"},
    {"openalex_id": "https://openalex.org/works/w364007801"},
    {"openalex_id": "https://openalex.org/works/w41602071"},
    {"openalex_id": "https://openalex.org/works/w4211200872"},
    {"openalex_id": "https://openalex.org/works/w4230697873"},
    {"openalex_id": "https://openalex.org/works/w4231138050"},
    {"openalex_id": "https://openalex.org/works/w4240884942"},
    {"openalex_id": "https://openalex.org/works/w4298053313"},
    {"openalex_id": "https://openalex.org/works/w43483391"},
    {"openalex_id": "https://openalex.org/works/w45919241"},
    {"openalex_id": "https://openalex.org/works/w55983382"},
    {"openalex_id": "https://openalex.org/works/w62389260"},
    {"openalex_id": "https://openalex.org/works/w75611220"},
]

ft = pd.DataFrame(inclusions)
ft["label_abstract_included"] = 1

# set labels and turn into single dataframe
df = utils.combine_datafiles(search, ft)
df = utils.drop_duplicates(df)

# Write output
utils.write_ids_files("Filges_2018", df)
