import pandas as pd
import sys

sys.path.append("../../scripts")
import utils

# get search
search = pd.read_csv("https://osf.io/kw8uy/download")
search.rename(columns={"label_included": "label_abstract_included"}, inplace=True)
search = utils.extract_doi(search, "DOI")
search = utils.extract_doi(search, "url")

# FT taken from paper references
inclusions = [
    {"openalex_id": "https://openalex.org/w2729748557"},
    {"openalex_id": "https://openalex.org/W1595368241"},
    {"openalex_id": "https://openalex.org/W1786598942"},
    {"openalex_id": "https://openalex.org/W1964821885"},
    {"openalex_id": "https://openalex.org/W1967993640"},
    {"openalex_id": "https://openalex.org/W1970123189"},
    {"openalex_id": "https://openalex.org/W1977466453"},
    {"openalex_id": "https://openalex.org/W1979167310"},
    {"openalex_id": "https://openalex.org/W1980019021"},
    {"openalex_id": "https://openalex.org/W1983553433"},
    {"openalex_id": "https://openalex.org/W1984930366"},
    {"openalex_id": "https://openalex.org/W1992456662"},
    {"openalex_id": "https://openalex.org/W1994265318"},
    {"openalex_id": "https://openalex.org/W1996537993"},
    {"openalex_id": "https://openalex.org/W2006386917"},
    {"openalex_id": "https://openalex.org/W2007488894"},
    {"openalex_id": "https://openalex.org/W2010810415"},
    {"openalex_id": "https://openalex.org/W2012952069"},
    {"openalex_id": "https://openalex.org/W2014655176"},
    {"openalex_id": "https://openalex.org/W2050525522"},
    {"openalex_id": "https://openalex.org/W2052031110"},
    {"openalex_id": "https://openalex.org/W2060937177"},
    {"openalex_id": "https://openalex.org/W2061016106"},
    {"openalex_id": "https://openalex.org/W2062428352"},
    {"openalex_id": "https://openalex.org/W2067873718"},
    {"openalex_id": "https://openalex.org/W2070096157"},
    {"openalex_id": "https://openalex.org/W2070617628"},
    {"openalex_id": "https://openalex.org/W2073034486"},
    {"openalex_id": "https://openalex.org/W2102535391"},
    {"openalex_id": "https://openalex.org/W2115528968"},
    {"openalex_id": "https://openalex.org/W2119971757"},
    {"openalex_id": "https://openalex.org/W2141880538"},
    {"openalex_id": "https://openalex.org/W2142203847"},
    {"openalex_id": "https://openalex.org/W2147823098"},
    {"openalex_id": "https://openalex.org/W2148285219"},
    {"openalex_id": "https://openalex.org/W2149392059"},
    {"openalex_id": "https://openalex.org/W2155229164"},
    {"openalex_id": "https://openalex.org/W2156782076"},
    {"openalex_id": "https://openalex.org/W2158805146"},
    {"openalex_id": "https://openalex.org/W2164225358"},
    {"openalex_id": "https://openalex.org/W2165810647"},
    {"openalex_id": "https://openalex.org/W2166389841"},
    {"openalex_id": "https://openalex.org/W2188352029"},
    {"openalex_id": "https://openalex.org/W2253041911"},
    {"openalex_id": "https://openalex.org/W2264081937"},
    {"openalex_id": "https://openalex.org/W2264266791"},
    {"openalex_id": "https://openalex.org/W2286662403"},
    {"openalex_id": "https://openalex.org/W2298496603"},
    {"openalex_id": "https://openalex.org/W2341712885"},
    {"openalex_id": "https://openalex.org/W2400378131"},
    {"openalex_id": "https://openalex.org/W2485358285"},
    {"openalex_id": "https://openalex.org/W2527948461"},
    {"openalex_id": "https://openalex.org/W2597779828"},
    {"openalex_id": "https://openalex.org/W2756554811"},
    {"openalex_id": "https://openalex.org/W2775733501"},
    {"openalex_id": "https://openalex.org/W2804624037"},
    {"openalex_id": "https://openalex.org/W609241950"},
    {"openalex_id": "https://openalex.org/W81681833"},
    {"openalex_id": "https://openalex.org/works/w100747293"},
    {"openalex_id": "https://openalex.org/works/w119570081"},
    {"openalex_id": "https://openalex.org/works/w12595656"},
    {"openalex_id": "https://openalex.org/works/w1468923727"},
    {"openalex_id": "https://openalex.org/works/w1491776623"},
    {"openalex_id": "https://openalex.org/works/w1588917084"},
    {"openalex_id": "https://openalex.org/works/w1604951120"},
    {"openalex_id": "https://openalex.org/works/w162357650"},
    {"openalex_id": "https://openalex.org/works/w1661869790"},
    {"openalex_id": "https://openalex.org/works/w1747540442"},
    {"openalex_id": "https://openalex.org/works/w1849640876"},
    {"openalex_id": "https://openalex.org/works/w190980244"},
    {"openalex_id": "https://openalex.org/works/w1953497378"},
    {"openalex_id": "https://openalex.org/works/w1997853537"},
    {"openalex_id": "https://openalex.org/works/w204690161"},
    {"openalex_id": "https://openalex.org/works/w2062455773"},
    {"openalex_id": "https://openalex.org/works/w2073617744"},
    {"openalex_id": "https://openalex.org/works/w2112853977"},
    {"openalex_id": "https://openalex.org/works/w2130178833"},
    {"openalex_id": "https://openalex.org/works/w2139462178"},
    {"openalex_id": "https://openalex.org/works/w2139746251"},
    {"openalex_id": "https://openalex.org/works/w2171893566"},
    {"openalex_id": "https://openalex.org/works/w2198605508"},
    {"openalex_id": "https://openalex.org/works/w2211180395"},
    {"openalex_id": "https://openalex.org/works/w2242787558"},
    {"openalex_id": "https://openalex.org/works/w2256774132"},
    {"openalex_id": "https://openalex.org/works/w2259660087"},
    {"openalex_id": "https://openalex.org/works/w2268732791"},
    {"openalex_id": "https://openalex.org/works/w2287122782"},
    {"openalex_id": "https://openalex.org/works/w2296306001"},
    {"openalex_id": "https://openalex.org/works/w2302541957"},
    {"openalex_id": "https://openalex.org/works/w2306881875"},
    {"openalex_id": "https://openalex.org/works/w2471988427"},
    {"openalex_id": "https://openalex.org/works/w2515994513"},
    {"openalex_id": "https://openalex.org/works/w2519854629"},
    {"openalex_id": "https://openalex.org/works/w2521341187"},
    {"openalex_id": "https://openalex.org/works/w252712565"},
    {"openalex_id": "https://openalex.org/works/w2531384795"},
    {"openalex_id": "https://openalex.org/works/w2595338461"},
    {"openalex_id": "https://openalex.org/works/w2598762931"},
    {"openalex_id": "https://openalex.org/works/w2725285980"},
    {"openalex_id": "https://openalex.org/works/w2735779322"},
    {"openalex_id": "https://openalex.org/works/w2889751345"},
    {"openalex_id": "https://openalex.org/works/w2900410729"},
    {"openalex_id": "https://openalex.org/works/w2954358828"},
    {"openalex_id": "https://openalex.org/works/w2965389562"},
    {"openalex_id": "https://openalex.org/works/w2991654324"},
    {"openalex_id": "https://openalex.org/works/w3015699786"},
    {"openalex_id": "https://openalex.org/works/w3025947428"},
    {"openalex_id": "https://openalex.org/works/w3200351998"},
    {"openalex_id": "https://openalex.org/works/w37446783"},
    {"openalex_id": "https://openalex.org/works/w384811172"},
    {"openalex_id": "https://openalex.org/works/w391702289"},
    {"openalex_id": "https://openalex.org/works/w4291596373"},
    {"openalex_id": "https://openalex.org/works/w46836809"},
    {"openalex_id": "https://openalex.org/works/w5006598"},
    {"openalex_id": "https://openalex.org/works/w566436095"},
    {"openalex_id": "https://openalex.org/works/w644761165"},
    {"openalex_id": "https://openalex.org/works/w762178056"},
    {"openalex_id": "https://openalex.org/works/w78507310"},
    {"openalex_id": "https://openalex.org/works/w964321232"},
]

ft = pd.DataFrame(inclusions)
ft["label_abstract_included"] = 1

# set labels and turn into single dataframe
df = utils.combine_datafiles(search, ft)
df = utils.drop_duplicates(df)

# Write output
utils.write_ids_files("Fong_2021", df)
