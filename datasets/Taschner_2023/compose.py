import pandas as pd
import sys

sys.path.append("../../scripts")
import utils

# get search
search = pd.read_csv("https://osf.io/s27un/download")
search.rename(columns={"label_included": "label_abstract_included"}, inplace=True)
search = utils.extract_doi(search, "url")

# FT taken from paper references
inclusions = [
    {"openalex_id": "https://openalex.org/W3166593245"},
    {"openalex_id": "https://openalex.org/W3204505736"},
    {"openalex_id": "https://openalex.org/W3199615203"},
    {"openalex_id": "https://openalex.org/W2226451587"},
    {"openalex_id": "https://openalex.org/W2582503981"},
    {"openalex_id": "https://openalex.org/W2587574827"},
    {"openalex_id": "https://openalex.org/W2973217180"},
    {"openalex_id": "https://openalex.org/W3159899185"},
    {"openalex_id": "https://openalex.org/W2955799023"},
    {"openalex_id": "https://openalex.org/W1975139937"},
    {"openalex_id": "https://openalex.org/W3110508367"},
    {"openalex_id": "https://openalex.org/W2002939911"},
    {"openalex_id": "https://openalex.org/W2061057928"},
    {"openalex_id": "https://openalex.org/W1976418862"},
    {"openalex_id": "https://openalex.org/W1969407683"},
    {"openalex_id": "https://openalex.org/W2515738175"},
    {"openalex_id": "https://openalex.org/W2603057638"},
    {"openalex_id": "https://openalex.org/W2618495133"},
    {"openalex_id": "https://openalex.org/W2784357577"},
    {"openalex_id": "https://openalex.org/W3047889165"},
    {"openalex_id": "https://openalex.org/W3111254511"},
    {"openalex_id": "https://openalex.org/W3208421331"},
    {"openalex_id": "https://openalex.org/W2101492341"},
    {"openalex_id": "https://openalex.org/W3006693993"},
    {"openalex_id": "https://openalex.org/W3021844853"},
    {"openalex_id": "https://openalex.org/W3164296572"},
    {"openalex_id": "https://openalex.org/W2008121107"},
    {"openalex_id": "https://openalex.org/W3027523811"},
    {"openalex_id": "https://openalex.org/W1947160652"},
    {"openalex_id": "https://openalex.org/W3211363333"},
    {"openalex_id": "https://openalex.org/W4205713690"},
    {"openalex_id": "https://openalex.org/W2332658173"},
    {"openalex_id": "https://openalex.org/W3159920374"},
    {"openalex_id": "https://openalex.org/W4205829416"},
    {"openalex_id": "https://openalex.org/W2612918544"},
    {"openalex_id": "https://openalex.org/W3176914405"},
    {"openalex_id": "https://openalex.org/W3202568664"},
    {"openalex_id": "https://openalex.org/W1985302499"},
    {"openalex_id": "https://openalex.org/W1484474373"},
    {"openalex_id": "https://openalex.org/W1572693328"},
    {"openalex_id": "https://openalex.org/W1580281138"},
    {"openalex_id": "https://openalex.org/W1639107336"},
    {"openalex_id": "https://openalex.org/W1730217591"},
    {"openalex_id": "https://openalex.org/W1737988125"},
    {"openalex_id": "https://openalex.org/W185544509"},
    {"openalex_id": "https://openalex.org/W1983141584"},
    {"openalex_id": "https://openalex.org/W1994449059"},
    {"openalex_id": "https://openalex.org/W2003492903"},
    {"openalex_id": "https://openalex.org/W2007518591"},
    {"openalex_id": "https://openalex.org/W2008978266"},
    {"openalex_id": "https://openalex.org/W2016319795"},
    {"openalex_id": "https://openalex.org/W2047280704"},
    {"openalex_id": "https://openalex.org/W2069488365"},
    {"openalex_id": "https://openalex.org/W2091331491"},
    {"openalex_id": "https://openalex.org/W2096400003"},
    {"openalex_id": "https://openalex.org/W2117895259"},
    {"openalex_id": "https://openalex.org/W2118434524"},
    {"openalex_id": "https://openalex.org/W2123749912"},
    {"openalex_id": "https://openalex.org/W2127113695"},
    {"openalex_id": "https://openalex.org/W2127568244"},
    {"openalex_id": "https://openalex.org/W2131208021"},
    {"openalex_id": "https://openalex.org/W2147744509"},
    {"openalex_id": "https://openalex.org/W2148385900"},
    {"openalex_id": "https://openalex.org/W2167783698"},
    {"openalex_id": "https://openalex.org/W2181333852"},
    {"openalex_id": "https://openalex.org/W2313452492"},
    {"openalex_id": "https://openalex.org/W2319202309"},
    {"openalex_id": "https://openalex.org/W2337313566"},
    {"openalex_id": "https://openalex.org/W2469304164"},
    {"openalex_id": "https://openalex.org/W2471607832"},
    {"openalex_id": "https://openalex.org/W2552605523"},
    {"openalex_id": "https://openalex.org/W2560446959"},
    {"openalex_id": "https://openalex.org/W2584595128"},
    {"openalex_id": "https://openalex.org/W2626600497"},
    {"openalex_id": "https://openalex.org/W2734967473"},
    {"openalex_id": "https://openalex.org/W2736803124"},
    {"openalex_id": "https://openalex.org/W2776821536"},
    {"openalex_id": "https://openalex.org/W2782242867"},
    {"openalex_id": "https://openalex.org/W2805398001"},
    {"openalex_id": "https://openalex.org/W2809115010"},
    {"openalex_id": "https://openalex.org/W2885985688"},
    {"openalex_id": "https://openalex.org/W2897843169"},
    {"openalex_id": "https://openalex.org/W2908266207"},
    {"openalex_id": "https://openalex.org/W2913064961"},
    {"openalex_id": "https://openalex.org/W2920799097"},
    {"openalex_id": "https://openalex.org/W2951986816"},
    {"openalex_id": "https://openalex.org/W2954878954"},
    {"openalex_id": "https://openalex.org/W2955684910"},
    {"openalex_id": "https://openalex.org/W2965916567"},
    {"openalex_id": "https://openalex.org/W2974435636"},
    {"openalex_id": "https://openalex.org/W2981296867"},
    {"openalex_id": "https://openalex.org/W2992416949"},
    {"openalex_id": "https://openalex.org/W2996180006"},
    {"openalex_id": "https://openalex.org/W3004381486"},
    {"openalex_id": "https://openalex.org/W3014617381"},
    {"openalex_id": "https://openalex.org/W3032278336"},
    {"openalex_id": "https://openalex.org/W3082956587"},
    {"openalex_id": "https://openalex.org/W3086762025"},
    {"openalex_id": "https://openalex.org/W3087294417"},
    {"openalex_id": "https://openalex.org/W3185159493"},
    {"openalex_id": "https://openalex.org/W3206538518"},
    {"openalex_id": "https://openalex.org/W39261212"},
    {"openalex_id": "https://openalex.org/W3162552957"},
    {"openalex_id": "https://openalex.org/W2937932923"},
    {"openalex_id": "https://openalex.org/W12409841"},
    {"openalex_id": "https://openalex.org/W2884780478"},
    {"openalex_id": "https://openalex.org/W2232397441"},
    {"openalex_id": "https://openalex.org/W2042069554"},
    {"openalex_id": "https://openalex.org/W2101040600"},
]

ft = pd.DataFrame(inclusions)
ft["label_abstract_included"] = 1

# set labels and turn into single dataframe
df = utils.combine_datafiles(search, ft)
df = utils.drop_duplicates(df)

# Write output
utils.write_ids_files("Taschner_2024", df)
